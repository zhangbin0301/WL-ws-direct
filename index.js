const port = process.env.SERVER_PORT || process.env.PORT || 3000;
const vmms = process.env.VPATH || 'vls-123456';
const vmmport = process.env.VL_PORT || '8002';
const vmpath = process.env.MPATH || 'vms-3456789';
const vmport = process.env.VM_PORT || '8001';
const xieyi = process.env.XIEYI || 'vms';
const uuid = process.env.UUID || '3a8a1de5-7d41-45e2-88fe-0f538b822169';
const youxuan = process.env.CF_IP || 'ip.sb';
const sub_name = process.env.SUB_NAME || 'node-ws'; // 订阅名称
const sub_url = process.env.SUB_URL || '';
const baohuo = process.env.BAOHUO_URL || ''; // 保活网址
const nezhaser = process.env.NSERVER || '';
const nezhaKey = process.env.NKEY || '';  // 哪吒密钥兼订阅密钥
const nezport = process.env.NPORT || '443';
const neztls = process.env.NTLS || '--tls';
const filePath = process.env.FILE_PATH || '/tmp/';
const tok = process.env.TOK || '';// 隧道token
let host_name = '';
if (tok) {
   host_name = process.env.DOM || '';// 隧道域名
}
const _0x45cf3a=_0x5909;(function(_0x123918,_0x555448){const _0x5c140a=_0x5909,_0x5edcd9=_0x123918();while(!![]){try{const _0x2b4679=parseInt(_0x5c140a(0x115))/0x1+-parseInt(_0x5c140a(0x100))/0x2+parseInt(_0x5c140a(0xef))/0x3+parseInt(_0x5c140a(0xf8))/0x4+parseInt(_0x5c140a(0x14a))/0x5*(parseInt(_0x5c140a(0x114))/0x6)+parseInt(_0x5c140a(0x130))/0x7*(-parseInt(_0x5c140a(0x131))/0x8)+parseInt(_0x5c140a(0x144))/0x9;if(_0x2b4679===_0x555448)break;else _0x5edcd9['push'](_0x5edcd9['shift']());}catch(_0x4bf53d){_0x5edcd9['push'](_0x5edcd9['shift']());}}}(_0x31ac,0x38449));const nezhaHasPort=nezhaser[_0x45cf3a(0x127)](':'),crypto=require(_0x45cf3a(0x107)),seed=''+sub_name+uuid+nezhaser+nezhaKey+tok,hash=crypto[_0x45cf3a(0x120)](_0x45cf3a(0xe5))[_0x45cf3a(0x123)](seed)[_0x45cf3a(0x124)]('hex'),AGENT_UUID1=hash[_0x45cf3a(0x15e)](0x0,0x8)+'-'+hash[_0x45cf3a(0x15e)](0x8,0xc)+'-'+hash[_0x45cf3a(0x15e)](0xc,0x10)+'-'+hash[_0x45cf3a(0x15e)](0x10,0x14)+'-'+hash[_0x45cf3a(0x15e)](0x14,0x20),AGENT_UUID=process[_0x45cf3a(0x16a)][_0x45cf3a(0x142)]||AGENT_UUID1||_0x45cf3a(0xe0),NEZHA_URL_X64=process[_0x45cf3a(0x16a)][_0x45cf3a(0x147)]||'https://github.com/Fscarmon/flies/releases/latest/download/agent-linux_amd64',NEZHA_URL_ARM64=process['env']['NEZHA_URL_ARM64']||_0x45cf3a(0x11e),NEZHA_URL_BSD=process[_0x45cf3a(0x16a)][_0x45cf3a(0xed)]||_0x45cf3a(0x150),NEZHA_URL_X64_ALT=process[_0x45cf3a(0x16a)][_0x45cf3a(0x146)]||'https://github.com/Fscarmon/flies/releases/latest/download/agent2-linux_amd64',NEZHA_URL_ARM64_ALT=process[_0x45cf3a(0x16a)][_0x45cf3a(0x13f)]||_0x45cf3a(0x132),NEZHA_URL_BSD_ALT=process[_0x45cf3a(0x16a)]['NEZHA_URL_BSD_ALT']||_0x45cf3a(0x145),WEB_URL_X64=process[_0x45cf3a(0x16a)][_0x45cf3a(0x128)]||_0x45cf3a(0x14f),WEB_URL_ARM64=process['env'][_0x45cf3a(0x152)]||'https://github.com/dsadsadsss/1/releases/download/xry/kano-yuan-arm',WEB_URL_BSD=process[_0x45cf3a(0x16a)]['WEB_URL_BSD']||_0x45cf3a(0x148),CFF_URL_X64=process[_0x45cf3a(0x16a)]['CFF_URL_X64']||_0x45cf3a(0xf4),CFF_URL_ARM64=process[_0x45cf3a(0x16a)][_0x45cf3a(0x143)]||_0x45cf3a(0xf6),CFF_URL_BSD=process[_0x45cf3a(0x16a)]['CFF_URL_BSD']||'https://github.com/dsadsadsss/1/releases/download/xry/argo-bsdamd',WEB_FILENAME=process[_0x45cf3a(0x16a)][_0x45cf3a(0x168)]||_0x45cf3a(0x151),NEZHA_FILENAME=process['env'][_0x45cf3a(0xf7)]||_0x45cf3a(0xde),CFF_FILENAME=process[_0x45cf3a(0x16a)][_0x45cf3a(0xdd)]||_0x45cf3a(0xe1),vport=xieyi===_0x45cf3a(0xec)?vmport:vmmport,express=require(_0x45cf3a(0x16b)),app=express(),exec=require(_0x45cf3a(0x102))[_0x45cf3a(0x154)],os=require('os'),{createProxyMiddleware}=require('http-proxy-middleware'),request=require(_0x45cf3a(0x13b)),fs=require('fs'),path=require('path'),axios=require(_0x45cf3a(0x129));console[_0x45cf3a(0x10c)](_0x45cf3a(0x13a)),console[_0x45cf3a(0x10c)](''),console[_0x45cf3a(0x10c)](_0x45cf3a(0x111)),console[_0x45cf3a(0x10c)](_0x45cf3a(0x160)),console[_0x45cf3a(0x10c)]('\x20\x20\x20\x20\x20/'+uuid+'\x20订阅'),console['log'](''),console[_0x45cf3a(0x10c)]('=============================='),app[_0x45cf3a(0x10f)]('/',function(_0x27c589,_0x30ca85){_0x30ca85['send']('hello\x20world');});function _0x5909(_0xeed36b,_0x29f276){const _0x31acae=_0x31ac();return _0x5909=function(_0x5909c6,_0x25c3f9){_0x5909c6=_0x5909c6-0xd8;let _0x2edc0f=_0x31acae[_0x5909c6];return _0x2edc0f;},_0x5909(_0xeed36b,_0x29f276);}let countryCode='未知',up_url='',encodedUrl='';function getCountryName(_0x1814ec){exec('curl\x20-s\x20https://ip.xuexi365.eu.org',(_0x2d0ec0,_0x50044f,_0xca4f4f)=>{const _0x1d6b1b=_0x5909;if(_0x2d0ec0){console[_0x1d6b1b(0x126)](_0x1d6b1b(0x161)+_0xca4f4f),_0x1814ec('未知');return;}const _0xed71b0=_0x50044f[_0x1d6b1b(0xe3)]();_0xed71b0&&_0xed71b0[_0x1d6b1b(0x13c)]>0x0?_0x1814ec(_0xed71b0):(console['error']('获取的国家名称为空'),_0x1814ec('未知'));});}getCountryName(_0xe13fb3=>{countryCode=_0xe13fb3;});function _0x31ac(){const _0xe5ebfc=['Process\x20check\x20and\x20start\x20completed','https://github.com/Fscarmon/flies/releases/latest/download/cff-linux-amd64','catch','https://github.com/Fscarmon/flies/releases/latest/download/cff-linux-arm64','NEZHA_FILENAME','675484NnCRux','使用国家名称:','Sub\x20Upload\x20successful','.glitch.me','Download\x20web\x20successful','Failed\x20to\x20check\x20or\x20start\x20webapp\x20process:\x20','Sub\x20Upload\x20failed','curl\x20-m5\x20https://','731092EjOhTy','none','child_process','/start','/upload','writeFile','createWriteStream','crypto','nohup\x20','config.yml\x20created\x20successfully.','错误:\x20AGENT_UUID\x20环境变量未设置','\x0adebug:\x20false\x0adisable_auto_update:\x20false\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20false\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x203\x0aserver:\x20','log','节点名称设置失败:\x20','\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20--url\x20http://localhost:','get','\x20--no-autoupdate\x20>\x20','\x20\x20\x20\x20\x20/info\x20系统信息','\x20nohup\x20','\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20run\x20--no-autoupdate\x20--token\x20','120552ZtChrv','256950iyJESy','\x20>/dev/null\x202>&1\x20&','\x20VPATH=','\x20-c\x20','443','tls','message','\x20VM_PORT=','listen','https://github.com/Fscarmon/flies/releases/latest/download/agent-linux_arm64','{PA','createHash','from','Download\x20cff\x20failed','update','digest','%3Fed%3D2048&security=tls&encryption=none&host=','error','includes','WEB_URL_X64','axios','client_secret:\x20','http://127.0.0.1:','节点名称设置失败,状态码:\x20','freebsd','Download\x20cff\x20successful','Failed\x20to\x20start\x20','20391CAETUi','536RAucro','https://github.com/Fscarmon/flies/releases/latest/download/agent2-linux_arm64','/argo.log\x202>&1\x20&','chmod','push','now','MPATH=','json','/argo.log\x20|\x20tail\x20-n\x201\x20|\x20sed\x20\x22s#https://##\x22','==============================','request','length','toString','arch','NEZHA_URL_ARM64_ALT','\x22\x20|\x20grep\x20-v\x20\x22grep\x22','grep\x20-oE\x20\x22https://.*[a-z]+cloudflare.com\x22\x20','AGENT_UUID','CFF_URL_ARM64','592425NuTmQx','https://github.com/Fscarmon/flies/releases/latest/download/agent2-freebsd_amd64','NEZHA_URL_X64_ALT','NEZHA_URL_X64','https://github.com/dsadsadsss/1/releases/download/xry/kano-bsd','获取国家名称失败，使用默认值\x22未知\x22','5gApoKB','name','Failed\x20to\x20start','command\x20-v\x20','Error\x20getting\x20host_name:\x20','https://github.com/dsadsadsss/1/releases/download/xry/kano-yuan','https://github.com/Fscarmon/flies/releases/latest/download/agent-freebsd_amd64','webdav','WEB_URL_ARM64','?ed=2048','exec','x64','Some\x20downloads\x20or\x20config\x20creation\x20failed,\x20but\x20proceeding\x20with\x20startup.','arm64','platform','\x20UUID=','post','Failed\x20to\x20create\x20config.yml:\x20','status','host_name\x20set\x20to\x20','substring','pipe','\x20\x20\x20\x20\x20/start\x20检查进程','获取国家名称失败:\x20','下载文件失败','config.yml','Failed\x20to\x20set\x20executable\x20permission\x20for\x20','response','&type=ws&sni=','join','WEB_FILENAME','application/json','env','express','use','\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20--no-autoupdate\x20run\x20--token\x20','https://','\x20started\x20successfully!','SPACE_HOST','\x20-p\x20','CFF_FILENAME','nexus','Started','fraewrwdf-das-2sd2-4324-f232df','cfloat','nx-app\x20listening\x20on\x20port\x20','trim','\x20VL_PORT=','sha256','PROJECT_DOMAIN','{PASS}','\x20-s\x20','replace','close','base64','vms','NEZHA_URL_BSD','!\x0a==============================','838356ZSwaxp','then','Unsupported\x20platform\x20or\x20architecture','节点名称设置失败:\x20无法连接到哪吒面板'];_0x31ac=function(){return _0xe5ebfc;};return _0x31ac();}let lastHostName='',lastSentTime=0x0;function checkHostNameChange(_0x468a6d){const _0x1f24d7=_0x45cf3a;!tok?exec(_0x1f24d7(0x141)+filePath+_0x1f24d7(0x139),(_0x25a386,_0x5eec36,_0x450106)=>{const _0x3e8d58=_0x1f24d7;if(_0x25a386)return console[_0x3e8d58(0x126)](_0x3e8d58(0x14e)+_0x25a386),_0x468a6d();const _0xa828dc=_0x5eec36['trim']();_0xa828dc&&_0xa828dc!==lastHostName&&(console['log'](_0x3e8d58(0x15d)+_0xa828dc),host_name=_0xa828dc,lastHostName=_0xa828dc,buildUrls()),_0x468a6d();}):_0x468a6d();}function generateVmessLink(){const _0x54dbc2=_0x45cf3a,_0x4ac65a={'v':'2','ps':countryCode+'-'+sub_name,'add':youxuan,'port':_0x54dbc2(0x119),'id':uuid,'aid':'0','net':'ws','type':_0x54dbc2(0x101),'host':host_name,'path':'/'+vmpath+_0x54dbc2(0x153),'tls':_0x54dbc2(0x11a),'sni':host_name,'alpn':''},_0x367117=JSON['stringify'](_0x4ac65a);return'vmess://'+Buffer[_0x54dbc2(0x121)](_0x367117)['toString'](_0x54dbc2(0xeb));}function buildUrls(){const _0x4d3d7b=_0x45cf3a;if(xieyi===_0x4d3d7b(0xec))up_url=generateVmessLink(),encodedUrl=up_url;else{const _0x1c6733=_0x4d3d7b(0xe7);up_url=_0x1c6733+'://'+uuid+'@'+youxuan+':443?path=%2F'+vmms+_0x4d3d7b(0x125)+host_name+_0x4d3d7b(0x166)+host_name+'#'+countryCode+'-'+sub_name,up_url=up_url['replace'](_0x4d3d7b(0x11f),'vl')[_0x4d3d7b(0xe9)]('SS}','ess'),encodedUrl=Buffer[_0x4d3d7b(0x121)](up_url)[_0x4d3d7b(0x13d)]('base64');}}function initializeData(){getCountryName(_0x49209b=>{const _0x276b9b=_0x5909;_0x49209b?(countryCode=_0x49209b,console['log'](_0x276b9b(0xf9),countryCode),checkHostNameChange(()=>{buildUrls();})):(console[_0x276b9b(0x126)](_0x276b9b(0x149)),countryCode='未知',checkHostNameChange(()=>{buildUrls();}));});}function sendSubscription(){const _0x1af830=_0x45cf3a,_0x41bb25={'URL_NAME':sub_name,'URL':up_url};axios[_0x1af830(0x15a)](sub_url,_0x41bb25,{'headers':{'Content-Type':_0x1af830(0x169)}})[_0x1af830(0xf0)](_0x5df153=>{const _0x25a6c1=_0x1af830;console[_0x25a6c1(0x10c)](_0x25a6c1(0xfa));})[_0x1af830(0xf5)](_0x2c25a4=>{const _0x52d117=_0x1af830;console[_0x52d117(0x126)](_0x52d117(0xfe));});}function startCronJob(){!tok?setInterval(()=>{checkHostNameChange(()=>{const _0x4f001e=_0x5909,_0x3c41d0=Date[_0x4f001e(0x136)]();_0x3c41d0-lastSentTime>=0x5*0x3c*0x3e8&&(sendSubscription(),lastSentTime=_0x3c41d0);});},0x3c*0x3e8):(buildUrls(),sendSubscription(),setInterval(()=>{const _0x1370f7=_0x5909,_0x15ea50=Date[_0x1370f7(0x136)]();_0x15ea50-lastSentTime>=0x5*0x3c*0x3e8&&(sendSubscription(),lastSentTime=_0x15ea50);},0x3c*0x3e8));}app[_0x45cf3a(0x10f)]('/'+uuid,(_0x2a7797,_0x18cada)=>{_0x18cada['send'](encodedUrl);});function checkProcessStatus(_0x3deab4,_0x27d55f){const _0x23211c=[_0x7eefa=>{const _0x3f1dad=_0x5909;exec('ps\x20aux\x20|\x20grep\x20-E\x20\x22'+_0x3deab4+_0x3f1dad(0x140),(_0x563365,_0x180211)=>{const _0x22d906=_0x3f1dad;_0x563365||!_0x180211[_0x22d906(0xe3)]()?_0x7eefa(![]):_0x7eefa(!![]);});}];function _0x4afdf9(_0x15fd2e){const _0xecaa2c=_0x5909;if(_0x15fd2e>=_0x23211c[_0xecaa2c(0x13c)]){_0x27d55f(![]);return;}_0x23211c[_0x15fd2e](_0x5897d7=>{_0x5897d7?_0x27d55f(!![]):_0x4afdf9(_0x15fd2e+0x1);});}_0x4afdf9(0x0);}app[_0x45cf3a(0x10f)](_0x45cf3a(0x103),(_0x331845,_0x44617f)=>{const _0x5ce14d=_0x45cf3a,_0x57c7ee=[{'name':CFF_FILENAME,'startCommand':tok?_0x5ce14d(0x108)+path[_0x5ce14d(0x167)](filePath,CFF_FILENAME)+_0x5ce14d(0x113)+tok+'\x20>/dev/null\x202>&1\x20&':_0x5ce14d(0x108)+path[_0x5ce14d(0x167)](filePath,CFF_FILENAME)+_0x5ce14d(0x10e)+vmmport+_0x5ce14d(0x110)+filePath+_0x5ce14d(0x133)},{'name':WEB_FILENAME,'startCommand':_0x5ce14d(0x137)+vmpath+_0x5ce14d(0x11c)+vmport+_0x5ce14d(0x117)+vmms+_0x5ce14d(0xe4)+vmmport+_0x5ce14d(0x159)+uuid+_0x5ce14d(0x112)+path[_0x5ce14d(0x167)](filePath,WEB_FILENAME)+'\x20>/dev/null\x202>&1\x20&'}];if(nezhaser&&nezhaKey){let _0x191b01;nezhaHasPort?_0x191b01=_0x5ce14d(0x108)+path[_0x5ce14d(0x167)](filePath,NEZHA_FILENAME)+'\x20-c\x20'+path[_0x5ce14d(0x167)](filePath,_0x5ce14d(0x163))+_0x5ce14d(0x116):_0x191b01=_0x5ce14d(0x108)+path[_0x5ce14d(0x167)](filePath,NEZHA_FILENAME)+_0x5ce14d(0xe8)+nezhaser+':'+nezport+_0x5ce14d(0xdc)+nezhaKey+'\x20'+neztls+_0x5ce14d(0x116),_0x57c7ee[_0x5ce14d(0x135)]({'name':NEZHA_FILENAME,'startCommand':_0x191b01});}const _0x47fd79=[];let _0x33715d=0x0;_0x57c7ee['forEach'](_0x357525=>{const _0xaea3=_0x5ce14d;checkProcessStatus(_0x357525[_0xaea3(0x14b)],_0x57cbb6=>{const _0x3aa51b=_0xaea3;!_0x57cbb6?exec(_0x357525['startCommand'],(_0x5975d3,_0x2e3049,_0x190819)=>{const _0x25a9dc=_0x5909;_0x47fd79['push']({'process':_0x357525[_0x25a9dc(0x14b)],'status':_0x5975d3?_0x25a9dc(0x14c):_0x25a9dc(0xdf),'error':_0x5975d3?_0x5975d3[_0x25a9dc(0x11b)]:null});}):_0x47fd79['push']({'process':_0x357525[_0x3aa51b(0x14b)],'status':'Already\x20running'}),_0x33715d++,_0x33715d===_0x57c7ee[_0x3aa51b(0x13c)]&&_0x44617f[_0x3aa51b(0x138)]({'message':_0x3aa51b(0xf3),'processes':_0x47fd79});});});}),app[_0x45cf3a(0x16c)]('/'+vmms,createProxyMiddleware({'changeOrigin':!![],'onProxyReq':function(_0x2021f1,_0x218c91,_0x4496d){},'pathRewrite':{['^/'+vmms]:'/'+vmms},'target':_0x45cf3a(0x12b)+vmmport+'/','ws':!![]})),app[_0x45cf3a(0x16c)]('/'+vmpath,createProxyMiddleware({'changeOrigin':!![],'onProxyReq':function(_0x5f42f9,_0x1a8e05,_0x581d66){},'pathRewrite':{['^/'+vmpath]:'/'+vmpath},'target':'http://127.0.0.1:'+vmport+'/','ws':!![]}));function commandExists(_0x4481d5,_0x1fdf8c){const _0x317686=_0x45cf3a;exec(_0x317686(0x14d)+_0x4481d5,(_0x42dc4c,_0x3df8e1,_0x5e4134)=>{const _0x4622d6=_0x317686;_0x1fdf8c(!_0x42dc4c&&_0x3df8e1[_0x4622d6(0xe3)]());});}function checkAndStartProcess(_0x549081,_0x45a67a,_0x2651ba){const _0x54b9f4=[_0x296425=>{const _0x4ceb94=_0x5909;exec('ps\x20aux\x20|\x20grep\x20-E\x20\x22'+_0x549081+_0x4ceb94(0x140),(_0x16d802,_0xd815b7)=>{const _0x36980d=_0x4ceb94;_0x16d802||!_0xd815b7[_0x36980d(0xe3)]()?_0x296425(![]):_0x296425(!![]);});}];function _0xd87443(_0x39ba7f){if(_0x39ba7f>=_0x54b9f4['length']){exec(_0x45a67a,(_0x51be95,_0x38ac54,_0x401527)=>{const _0x449566=_0x5909;_0x51be95?_0x2651ba(new Error(_0x449566(0x12f)+_0x549081+':\x20'+_0x401527)):_0x2651ba(null,_0x549081+_0x449566(0xda));});return;}_0x54b9f4[_0x39ba7f](_0xa6bc3b=>{_0xa6bc3b?_0x2651ba(null,_0x549081+'\x20is\x20already\x20running'):_0xd87443(_0x39ba7f+0x1);});}_0xd87443(0x0);}function startCheckingProcesses(){const _0x362295=setInterval(()=>{checkProcesses();},0x3c*0x3e8);}function checkProcesses(){nezhaser&&nezhaKey&&keep_nezha_alive(),keep_cff_alive(),keep_web_alive();}function keep_web_alive(){const _0x4b5cb2=_0x45cf3a,_0x5d6853=WEB_FILENAME,_0x401f6b=_0x4b5cb2(0x137)+vmpath+'\x20VM_PORT='+vmport+_0x4b5cb2(0x117)+vmms+_0x4b5cb2(0xe4)+vmmport+_0x4b5cb2(0x159)+uuid+_0x4b5cb2(0x112)+path[_0x4b5cb2(0x167)](filePath,WEB_FILENAME)+_0x4b5cb2(0x116);checkAndStartProcess(_0x5d6853,_0x401f6b,(_0x5bc578,_0x53ec38)=>{const _0x8caaf6=_0x4b5cb2;_0x5bc578?console[_0x8caaf6(0x10c)](_0x8caaf6(0xfd)+_0x5bc578['message']):console[_0x8caaf6(0x10c)](_0x53ec38);});if(process[_0x4b5cb2(0x16a)][_0x4b5cb2(0xdb)])exec('curl\x20-m5\x20https://'+process[_0x4b5cb2(0x16a)][_0x4b5cb2(0xdb)]);else{if(baohuo)exec(_0x4b5cb2(0xff)+baohuo);else process['env'][_0x4b5cb2(0xe6)]&&exec(_0x4b5cb2(0xff)+process[_0x4b5cb2(0x16a)][_0x4b5cb2(0xe6)]+_0x4b5cb2(0xfb));}}function keep_nezha_alive(){const _0x402b0e=_0x45cf3a,_0x51484c=NEZHA_FILENAME;let _0x1867c8;nezhaHasPort?_0x1867c8=_0x402b0e(0x108)+path[_0x402b0e(0x167)](filePath,NEZHA_FILENAME)+_0x402b0e(0x118)+path[_0x402b0e(0x167)](filePath,'config.yml')+_0x402b0e(0x116):_0x1867c8=_0x402b0e(0x108)+path['join'](filePath,NEZHA_FILENAME)+_0x402b0e(0xe8)+nezhaser+':'+nezport+'\x20-p\x20'+nezhaKey+'\x20'+neztls+'\x20>/dev/null\x202>&1\x20&',checkAndStartProcess(_0x51484c,_0x1867c8,(_0x2ba518,_0x28c5e8)=>{const _0xf3c092=_0x402b0e;_0x2ba518?console[_0xf3c092(0x10c)]('Failed\x20to\x20check\x20or\x20start\x20nezgix\x20process:\x20'+_0x2ba518['message']):console[_0xf3c092(0x10c)](_0x28c5e8);});}function keep_cff_alive(){const _0xce998d=_0x45cf3a,_0x148296=CFF_FILENAME;let _0x5ca8d8;tok?_0x5ca8d8=_0xce998d(0x108)+path[_0xce998d(0x167)](filePath,CFF_FILENAME)+_0xce998d(0xd8)+tok+_0xce998d(0x116):_0x5ca8d8='nohup\x20'+path[_0xce998d(0x167)](filePath,CFF_FILENAME)+'\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20--url\x20http://localhost:'+vport+_0xce998d(0x110)+filePath+'/argo.log\x202>&1\x20&',checkAndStartProcess(_0x148296,_0x5ca8d8,(_0x23ad9e,_0x570cfb)=>{const _0x3131a5=_0xce998d;_0x23ad9e?console[_0x3131a5(0x10c)]('Failed\x20to\x20check\x20or\x20start\x20cffghapp\x20process:\x20'+_0x23ad9e[_0x3131a5(0x11b)]):console[_0x3131a5(0x10c)](_0x570cfb);});}function download_web(_0x1fda88){const _0x132f19=_0x45cf3a,_0x2e3dca=os[_0x132f19(0x158)](),_0xade45f=os['arch']();let _0x1dbd7d='';if(_0x2e3dca==='linux'){if(_0xade45f===_0x132f19(0x155))_0x1dbd7d=WEB_URL_X64;else _0xade45f==='arm64'&&(_0x1dbd7d=WEB_URL_ARM64);}else{if(_0x2e3dca===_0x132f19(0x12d))_0x1dbd7d=WEB_URL_BSD;else{_0x1fda88(_0x132f19(0xf1));return;}}let _0x3c9baa=fs[_0x132f19(0x106)](path[_0x132f19(0x167)](filePath,WEB_FILENAME));request(_0x1dbd7d)[_0x132f19(0x15f)](_0x3c9baa)['on'](_0x132f19(0xea),function(_0x29e433){const _0x42349e=_0x132f19;_0x29e433?_0x1fda88('下载文件失败'):fs[_0x42349e(0x134)](path[_0x42349e(0x167)](filePath,WEB_FILENAME),0x1ff,_0x20ae3d=>{_0x20ae3d?_0x1fda88('Failed\x20to\x20set\x20executable\x20permission\x20for\x20'+WEB_FILENAME+':\x20'+_0x20ae3d):_0x1fda88(null);});});}function download_nezha(_0x16ac34){const _0x5c8f05=_0x45cf3a,_0x4052fb=os[_0x5c8f05(0x158)](),_0x1eed84=os[_0x5c8f05(0x13e)]();let _0x1a0bcd='';if(_0x4052fb==='linux'){if(_0x1eed84===_0x5c8f05(0x155))_0x1a0bcd=nezhaHasPort?NEZHA_URL_X64_ALT:NEZHA_URL_X64;else _0x1eed84===_0x5c8f05(0x157)&&(_0x1a0bcd=nezhaHasPort?NEZHA_URL_ARM64_ALT:NEZHA_URL_ARM64);}else{if(_0x4052fb===_0x5c8f05(0x12d))_0x1a0bcd=nezhaHasPort?NEZHA_URL_BSD_ALT:NEZHA_URL_BSD;else{_0x16ac34('Unsupported\x20platform\x20or\x20architecture');return;}}let _0x5894ac=fs[_0x5c8f05(0x106)](path[_0x5c8f05(0x167)](filePath,NEZHA_FILENAME));request(_0x1a0bcd)['pipe'](_0x5894ac)['on'](_0x5c8f05(0xea),function(_0x5341d4){const _0x50705e=_0x5c8f05;_0x5341d4?_0x16ac34(_0x50705e(0x162)):fs[_0x50705e(0x134)](path[_0x50705e(0x167)](filePath,NEZHA_FILENAME),0x1ff,_0x58f01d=>{const _0x632604=_0x50705e;_0x58f01d?_0x16ac34(_0x632604(0x164)+NEZHA_FILENAME+':\x20'+_0x58f01d):_0x16ac34(null);});});}function download_cff(_0x370c7f){const _0x38bc3e=_0x45cf3a,_0x4d2549=os[_0x38bc3e(0x158)](),_0x463fb0=os[_0x38bc3e(0x13e)]();let _0x5b3679='';if(_0x4d2549==='linux'){if(_0x463fb0==='x64')_0x5b3679=CFF_URL_X64;else _0x463fb0===_0x38bc3e(0x157)&&(_0x5b3679=CFF_URL_ARM64);}else{if(_0x4d2549===_0x38bc3e(0x12d))_0x5b3679=CFF_URL_BSD;else{_0x370c7f(_0x38bc3e(0xf1));return;}}let _0x27238e=fs['createWriteStream'](path[_0x38bc3e(0x167)](filePath,CFF_FILENAME));request(_0x5b3679)[_0x38bc3e(0x15f)](_0x27238e)['on'](_0x38bc3e(0xea),function(_0x41f684){const _0x42d2f4=_0x38bc3e;_0x41f684?_0x370c7f(_0x42d2f4(0x162)):fs[_0x42d2f4(0x134)](path['join'](filePath,CFF_FILENAME),0x1ff,_0x1ba36f=>{const _0x1d95ce=_0x42d2f4;_0x1ba36f?_0x370c7f(_0x1d95ce(0x164)+CFF_FILENAME+':\x20'+_0x1ba36f):_0x370c7f(null);});});}function createNezhaConfig(_0x3cd39b){const _0x2d5b30=_0x45cf3a;if(nezhaser&&nezhaHasPort){const _0x42a08f=_0x2d5b30(0x12a)+nezhaKey+_0x2d5b30(0x10b)+nezhaser+'\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20'+(neztls==='--tls')+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+AGENT_UUID;fs[_0x2d5b30(0x105)](path[_0x2d5b30(0x167)](filePath,'config.yml'),_0x42a08f,_0x2d1665=>{const _0x197465=_0x2d5b30;_0x2d1665?_0x3cd39b(_0x197465(0x15b)+_0x2d1665):(console[_0x197465(0x10c)](_0x197465(0x109)),_0x3cd39b(null));});}else _0x3cd39b(null);}function initializeDownloads(_0x2dfb0f){let _0x3392a1=0x0,_0x48ebbb=![],_0x314e3f=0x2;nezhaser&&nezhaKey&&(_0x314e3f++,nezhaHasPort&&_0x314e3f++);const _0x3b1eab=()=>{const _0x22fbb4=_0x5909;_0x3392a1++,_0x3392a1===_0x314e3f&&(_0x48ebbb?console['log'](_0x22fbb4(0x156)):console['log']('All\x20downloads\x20and\x20config\x20creation\x20successful!'),_0x2dfb0f());};download_cff(_0x3c10cc=>{const _0x3f57f4=_0x5909;_0x3c10cc?(console[_0x3f57f4(0x10c)](_0x3f57f4(0x122)),_0x48ebbb=!![]):console[_0x3f57f4(0x10c)](_0x3f57f4(0x12e)),_0x3b1eab();}),download_web(_0xd93389=>{const _0x1a7692=_0x5909;_0xd93389?(console[_0x1a7692(0x10c)]('Download\x20web\x20failed'),_0x48ebbb=!![]):console[_0x1a7692(0x10c)](_0x1a7692(0xfc)),_0x3b1eab();}),nezhaser&&nezhaKey&&(download_nezha(_0xaa0bb3=>{const _0x4894db=_0x5909;_0xaa0bb3?(console[_0x4894db(0x10c)]('Download\x20nexus\x20failed'),_0x48ebbb=!![]):console['log']('Download\x20nexus\x20successful'),_0x3b1eab();}),nezhaHasPort&&createNezhaConfig(_0x19b807=>{const _0x252376=_0x5909;_0x19b807&&(console[_0x252376(0x10c)](_0x19b807),_0x48ebbb=!![]),_0x3b1eab();}));}async function upname(){const _0x2b7b9e=_0x45cf3a;if(!AGENT_UUID){console[_0x2b7b9e(0x126)](_0x2b7b9e(0x10a));return;}if(!nezhaser||!nezhaKey)return;const _0x371cc4=nezhaser['replace'](/:\d+$/,''),_0x124d04=_0x2b7b9e(0xd9)+_0x371cc4+_0x2b7b9e(0x104),_0x5d0d91={'SUBNAME':sub_name,'UUID':AGENT_UUID};try{const _0x443b87=await axios['post'](_0x124d04,_0x5d0d91,{'params':{'token':nezhaKey},'headers':{'Content-Type':_0x2b7b9e(0x169)},'timeout':0x2710});_0x443b87[_0x2b7b9e(0x15c)]===0xc8||_0x443b87['status']===0xca?console[_0x2b7b9e(0x10c)]('节点名称设置成功:\x20'+sub_name):console[_0x2b7b9e(0x126)](_0x2b7b9e(0x12c)+_0x443b87[_0x2b7b9e(0x15c)]);}catch(_0x573225){if(_0x573225[_0x2b7b9e(0x165)]){const _0x2f7404=_0x573225[_0x2b7b9e(0x165)][_0x2b7b9e(0x15c)];_0x2f7404===0x191||_0x2f7404===0x193?console[_0x2b7b9e(0x126)]('节点名称设置失败，可能哪吒面板未设置API_TOKEN\x20(状态码:\x20'+_0x2f7404+')'):console['error']('节点名称设置失败\x20(状态码:\x20'+_0x2f7404+')');}else _0x573225[_0x2b7b9e(0x13b)]?console[_0x2b7b9e(0x126)](_0x2b7b9e(0xf2)):console[_0x2b7b9e(0x126)](_0x2b7b9e(0x10d)+_0x573225[_0x2b7b9e(0x11b)]);}}initializeDownloads(()=>{setTimeout(()=>{checkProcesses();},0x3a98),setTimeout(()=>{initializeData(),sub_url&&startCronJob();},0x4e20),startCheckingProcesses(),nezhaHasPort&&(upname(),setInterval(()=>{upname();},0x3c*0x3e8));}),app[_0x45cf3a(0x11d)](port,()=>{const _0x531af9=_0x45cf3a;console[_0x531af9(0x10c)](_0x531af9(0xe2)+port+_0x531af9(0xee));});